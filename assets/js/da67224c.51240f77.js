"use strict";(self.webpackChunkten_docs=self.webpackChunkten_docs||[]).push([[7072],{7999:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"tools-infrastructure/cross-chain-messaging","title":"Cross Chain Messaging","description":"TEN features a cross-chain messaging protocol, facilitating secure and decentralized communication across layers.","source":"@site/docs/tools-infrastructure/cross-chain-messaging.md","sourceDirName":"tools-infrastructure","slug":"/tools-infrastructure/cross-chain-messaging","permalink":"/docs/tools-infrastructure/cross-chain-messaging","draft":false,"unlisted":false,"editUrl":"https://github.com/ten-protocol/ten-documentation/blob/main/docs/tools-infrastructure/cross-chain-messaging.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Standard Bridge","permalink":"/docs/tools-infrastructure/standard-bridge"},"next":{"title":"Compatible Tools","permalink":"/docs/tools-infrastructure/compatible-tools"}}');var i=n(4848),r=n(8453);const a={sidebar_position:6},o="Cross Chain Messaging",c={},l=[{value:"How It Works",id:"how-it-works",level:2},{value:"Advanced Capabilities",id:"advanced-capabilities",level:2},{value:"Security",id:"security",level:2},{value:"Interface",id:"interface",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"cross-chain-messaging",children:"Cross Chain Messaging"})}),"\n",(0,i.jsx)(s.p,{children:"TEN features a cross-chain messaging protocol, facilitating secure and decentralized communication across layers."}),"\n",(0,i.jsxs)(s.p,{children:["The foundational contract for this feature is ",(0,i.jsx)(s.code,{children:"MessageBus"}),", present on both L1 and L2. On L1, it's nested under the management contract, while on L2, it's managed by the protocol."]}),"\n",(0,i.jsx)(s.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,i.jsxs)(s.p,{children:["Users invoke the ",(0,i.jsx)(s.code,{children:"publishMessage"})," function on ",(0,i.jsx)(s.code,{children:"MessageBus"}),". This function triggers an event, capturing the message details. The protocol then ensures this message is accessible on the counterpart ",(0,i.jsx)(s.code,{children:"MessageBus"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["To verify message receipt, users can call ",(0,i.jsx)(s.code,{children:"verifyMessageFinalized"})," on the receiving layer's ",(0,i.jsx)(s.code,{children:"MessageBus"}),". If the message matches the original details, it returns ",(0,i.jsx)(s.code,{children:"true"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["This mechanism allows for queries like: ",(0,i.jsx)(s.strong,{children:"'Has address 0xAAAA.. received 25WETH tokens on the bridge with address 0XAB0FF?'"}),". If the bridge confirms the receipt, the query returns true."]}),"\n",(0,i.jsx)(s.p,{children:"For messages published on TEN's L2, the management contract transports them to L1 during rollup submission. However, these messages must await the rollup's challenge period to be deemed final."}),"\n",(0,i.jsx)(s.h2,{id:"advanced-capabilities",children:"Advanced Capabilities"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"MessageBus"})," offers a method to query non-finalized delivered messages: ",(0,i.jsx)(s.code,{children:"getMessageTimeOfFinality"}),". This previews messages still within the challenge period."]}),"\n",(0,i.jsx)(s.p,{children:'Such "preview" functionality can empower dApps to offer faster-than-challenge-period finality. For instance, a contract might allow immediate withdrawals from a bridge at a fee, transferring withdrawal rights to the fee payer upon message finalization.'}),"\n",(0,i.jsx)(s.h2,{id:"security",children:"Security"}),"\n",(0,i.jsx)(s.p,{children:"The protocol listens only to events from the contract address linked to the management contract. Messages are tied to L1 blocks, recalculating state during reorganizations. L2 messages also link to L1 block hashes, ensuring state updates align with the correct fork."}),"\n",(0,i.jsxs)(s.p,{children:["The protocol securely manages the keys for the L2 contract within SGX. Extracting the private key controlling the L2 ",(0,i.jsx)(s.code,{children:"MessageBus"})," would necessitate breaching SGX. Even if achieved, the protocol would auto-reject such transactions, as it scans all external transactions."]}),"\n",(0,i.jsx)(s.h2,{id:"interface",children:"Interface"}),"\n",(0,i.jsxs)(s.p,{children:["Below are the interfaces for interacting with ",(0,i.jsx)(s.code,{children:"MessageBus"}),". For queries or issues, join our ",(0,i.jsx)(s.a,{href:"https://discord.gg/tVnNrQ35Ke",children:"Discord"}),"."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-solidity",children:"interface Structs {\n    struct CrossChainMessage {\n        address sender;\n        uint64  sequence;\n        uint32  nonce;\n        uint32  topic;\n        bytes   payload;\n        uint8   consistencyLevel;\n    }\n}\n\ninterface IMessageBus {\n    function publishMessage(\n        uint32 nonce,\n        uint32 topic,\n        bytes calldata payload, \n        uint8 consistencyLevel\n    ) external returns (uint64 sequence);\n\n    function verifyMessageFinalized(\n        Structs.CrossChainMessage calldata crossChainMessage\n    ) external view returns (bool);\n    \n    function getMessageTimeOfFinality(\n        Structs.CrossChainMessage calldata crossChainMessage\n    ) external view returns (uint256);\n}\n"})})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>o});var t=n(6540);const i={},r=t.createContext(i);function a(e){const s=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);