<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-smart-contract-features/data-access" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Data Access | TEN Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.ten.xyz/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.ten.xyz/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.ten.xyz/docs/smart-contract-features/data-access"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Data Access | TEN Documentation"><meta data-rh="true" name="description" content="Solidity encapsulates &quot;private&quot; state variables in a way that prevents them from being accessed by other contracts."><meta data-rh="true" property="og:description" content="Solidity encapsulates &quot;private&quot; state variables in a way that prevents them from being accessed by other contracts."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.ten.xyz/docs/smart-contract-features/data-access"><link data-rh="true" rel="alternate" href="https://docs.ten.xyz/docs/smart-contract-features/data-access" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.ten.xyz/docs/smart-contract-features/data-access" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Smart Contract Features","item":"https://docs.ten.xyz/docs/category/smart-contract-features"},{"@type":"ListItem","position":2,"name":"Data Access","item":"https://docs.ten.xyz/docs/smart-contract-features/data-access"}]}</script><link rel="stylesheet" href="/assets/css/styles.c2bd8e97.css">
<script src="/assets/js/runtime~main.e1395d6a.js" defer="defer"></script>
<script src="/assets/js/main.cdace186.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TEN Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="TEN Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/overview">Documentation</a><a href="https://medium.com/obscuro-labs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/introduction/introduction">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/smart-contract-features">Smart Contract Features</a><button aria-label="Collapse sidebar category &#x27;Smart Contract Features&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/smart-contract-features/data-access">Data Access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contract-features/native-entropy">Native secure entropy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contract-features/native-commit-reveal">Native commit-reveal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/smart-contract-features/transaction-timestamp">Precise transaction timestamp</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/write-a-ten-dapp">Write a TEN dApp</a><button aria-label="Expand sidebar category &#x27;Write a TEN dApp&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/run-a-ten-node">Run a TEN node</a><button aria-label="Expand sidebar category &#x27;Run a TEN node&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/governance">Governance</a><button aria-label="Expand sidebar category &#x27;Governance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/release-notes">Release Notes</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/smart-contract-features"><span>Smart Contract Features</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Data Access</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Data Access</h1></header>
<p>Solidity encapsulates &quot;private&quot; state variables in a way that prevents them from being accessed by other contracts.</p>
<p>However, private variables are readable externally via <a href="https://docs.alchemy.com/reference/eth-getstorageat" target="_blank" rel="noopener noreferrer">getStorageAt</a>, meaning contracts can&#x27;t truly have secrets.</p>
<p>TEN overcomes this limitation by offering &quot;Data Access Control&quot; primitives.</p>
<p>To achieve this, we had to:</p>
<ol>
<li>Run the Ethereum Virtual Machine inside a Trusted Execution Environment (TEE) and store the state in encrypted storage. This prevents the node operator from accessing the data.</li>
<li>Disable the <code>getStorageAt</code> method, so now contracts can have secrets (as long as the <code>private</code> state variables are not exposed via public view functions). This prevents anyone with RPC access to the node from reading the data.</li>
<li>Authenticate &quot;view function calls&quot; so that the smart contract knows who is calling the view function. Without this feature there is no &quot;Data Access <strong>Control</strong>&quot;, because the dApp developer can&#x27;t write access control logic.</li>
<li>Event logs are another way to expose data from a contract to the outside world. A practical platform needs a way to configure who can read the various event logs.</li>
<li>Control access to the &quot;Transaction Receipts&quot;, which contain the logs and status of the transaction.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-access-control-rules">Data Access Control Rules<a href="#data-access-control-rules" class="hash-link" aria-label="Direct link to Data Access Control Rules" title="Direct link to Data Access Control Rules">​</a></h2>
<p>Here, we&#x27;ll list the platform rules. The examples below will showcase how exactly to use these rules in practice.</p>
<ul>
<li>Any contract can be configured to be &quot;transparent&quot; or &quot;private&quot;. By default, it is &quot;private&quot;, which means the internal storage is not accessible. &quot;Transparent&quot; contracts behave exactly like Ethereum.</li>
<li>Any RPC call accessing data like: <code>eth_call</code>, <code>eth_estimateGas</code>, <code>eth_getTransactionReceipt</code>, <code>eth_logs</code>, must be signed by a <a href="/docs/smart-contract-features/4-smart-contracts.md">viewing key (VK)</a>. The VK itself must be signed by the main account. (Note that this is behind the scenes.)</li>
<li>Event log visibility is configurable. Each event log can be visible to one or multiple of the topics (indexed fields), and the sender of the transaction, only if the topic is the <code>address</code> of an &quot;Externally owned Account&quot; (EOA). The event log can also be configured to be &quot;public&quot; - visible to everyone.</li>
<li>When there is no configuration, the default event log visibility is:<!-- -->
<ul>
<li>Rule 1: Event logs that contain EOAs as topics are only visible to those EOAs.</li>
<li>Rule 2: Event logs that don&#x27;t contain any EOA are visible to everyone.</li>
</ul>
</li>
<li>As a general rule, transaction receipts are visible to:<!-- -->
<ul>
<li>anyone who can access at least one event log emitted by that transaction,</li>
<li>the sender of the transaction, and</li>
<li>everyone, if the transaction called a transparent contract.</li>
</ul>
</li>
<li><code>eth_getStorageAt</code> can be called on &quot;transparent&quot; contracts.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-access-control-example">Data Access Control Example<a href="#data-access-control-example" class="hash-link" aria-label="Direct link to Data Access Control Example" title="Direct link to Data Access Control Example">​</a></h2>
<p>Let&#x27;s illustrate with a basic storage dApp example where users can store and retrieve a number.</p>
<p>At every step, we&#x27;ll add a new feature and explain the difference between <code>TEN</code> and <code>Ethereum</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-basic-contract-with-a-public-variable">Step 1: Basic contract with a Public Variable<a href="#step-1-basic-contract-with-a-public-variable" class="hash-link" aria-label="Direct link to Step 1: Basic contract with a Public Variable" title="Direct link to Step 1: Basic contract with a Public Variable">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code">Code<a href="#code" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h4>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: MIT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract StorageExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) public storedValues;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function storeValue(uint256 value) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        storedValues[tx.origin] = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation">Explanation<a href="#explanation" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<p>In this step, we created a public variable <code>storedValues</code> that maps the provided value to the address of the user who called the <code>storeValue</code> function.</p>
<p>Because the variable is public, Solidity will provide a default public getter for it.</p>
<p>Since there are no data access restrictions, on both Ethereum and TEN, everyone will be able to read the values of all users by just calling the default public getter.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-converting-to-a-private-variable-with-an-explicit-getter-function">Step 2: Converting to a Private Variable with an explicit Getter Function<a href="#step-2-converting-to-a-private-variable-with-an-explicit-getter-function" class="hash-link" aria-label="Direct link to Step 2: Converting to a Private Variable with an explicit Getter Function" title="Direct link to Step 2: Converting to a Private Variable with an explicit Getter Function">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-1">Code<a href="#code-1" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h4>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract StorageExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) private _storedValues;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function storeValue(uint256 value) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _storedValues[tx.origin] = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getValue(address account) public view returns (uint256) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _storedValues[account];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-1">Explanation<a href="#explanation-1" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<p>The <code>storedValues</code> variable is now private, and we added a basic <code>getValue</code> function for users to retrieve their value.</p>
<p>On both Ethereum and TEN, anyone can call <code>getValue</code> to retrieve any value.<br>
<!-- -->On Ethereum, <code>_storedValues</code> can also be accessed directly with <code>getStorageAt</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-data-access-control">Step 3: Data Access Control<a href="#step-3-data-access-control" class="hash-link" aria-label="Direct link to Step 3: Data Access Control" title="Direct link to Step 3: Data Access Control">​</a></h3>
<p>In this step, we&#x27;ll add restrictions so users can only access their own data.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-2">Code<a href="#code-2" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h4>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract StorageExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) private _storedValues;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function storeValue(uint256 value) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _storedValues[tx.origin] = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getValue(address account) public view returns (uint256) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(tx.origin == account, &quot;Not authorised!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _storedValues[account];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-2">Explanation<a href="#explanation-2" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<p>The key line is: <code>require(tx.origin == account, &quot;Not authorised!&quot;);</code>, which ensures that the caller of the view function is the owner of the data.</p>
<p><strong>When deployed on TEN, this code guarantees that all users can only access their own values, and nobody can read the <code>_storedValues</code>.</strong></p>
<p>On Ethereum, the <code>tx.origin</code> is not authenticated, so the check above is not effective and <code>eth_getStorageAt</code> is available.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-emitting-events---default-visibility">Step 4: Emitting Events - Default Visibility<a href="#step-4-emitting-events---default-visibility" class="hash-link" aria-label="Direct link to Step 4: Emitting Events - Default Visibility" title="Direct link to Step 4: Emitting Events - Default Visibility">​</a></h3>
<p>Event logs notify UIs about state changes in smart contracts.</p>
<p>To improve our smart contract, we’ll emit an event when a user stores a value and milestone events when a specific size threshold is met.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-3">Code<a href="#code-3" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h4>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract StorageExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) private _storedValues;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 private totalCalls = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event DataChanged(address indexed account, uint256 newValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event MilestoneReached(uint256 noStoredValues);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function storeValue(uint256 value) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _storedValues[tx.origin] = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit DataChanged(tx.origin, value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        totalCalls++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (totalCalls % 1000 == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            emit MilestoneReached(totalCalls);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getValue(address account) public view returns (uint256) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(tx.origin == account, &quot;Not authorised!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _storedValues[account];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-3">Explanation<a href="#explanation-3" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<p>Notice how we defined the two events: <code>DataChanged</code> and <code>MilestoneReached</code>, and are emitting them in the <code>storeValue</code> function.</p>
<p>In Ethereum, everyone can query and subscribe to these events. If this was possible on TEN, it would completely break the functionality because you can see all the secret values.</p>
<p>Notice how in this version, we have no configuration for event log visibility, so we are relying on the default rules:</p>
<ul>
<li>Rule 1: Event logs that contain (&quot;Externally owned Account&quot;) EOAs as indexed fields (topics) are only visible to those EOAs.</li>
<li>Rule 2: Event logs that don&#x27;t contain any EOA are visible to everyone.</li>
</ul>
<p>In our case, the default rules ensure that:</p>
<ul>
<li><code>DataChanged</code> is visible only to the address that is storing the value.</li>
<li><code>MilestoneReached</code> is publicly visible.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-customising-event-visibility">Step 5: Customising Event Visibility<a href="#step-5-customising-event-visibility" class="hash-link" aria-label="Direct link to Step 5: Customising Event Visibility" title="Direct link to Step 5: Customising Event Visibility">​</a></h3>
<p>The default visibility rules are a good starting point, but complex dApps require greater flexibility.</p>
<p>TEN gives you explicit control over event visibility.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-4">Code<a href="#code-4" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h4>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// when implementing this interface, the platform will configure the visibility rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface ContractTransparencyConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enum Field { TOPIC1, TOPIC2, TOPIC3, SENDER, EVERYONE }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enum ContractCfg { TRANSPARENT, PRIVATE }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    struct EventLogConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 eventSignature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Field[] visibleTo;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    struct VisibilityConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ContractCfg contractCfg;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        EventLogConfig[] eventLogConfigs;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function visibilityRules() external pure returns (VisibilityConfig memory);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract StorageExample is ContractTransparencyConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) private _storedValues;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 private totalCalls = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event DataChanged(address indexed account, uint256 newValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event MilestoneReached(uint256 noStoredValues);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function storeValue(uint256 value) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _storedValues[tx.origin] = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit DataChanged(tx.origin, value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        totalCalls++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (totalCalls % 1000 == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            emit MilestoneReached(totalCalls);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getValue(address account) public view returns (uint256) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(tx.origin == account, &quot;Not authorised!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _storedValues[account];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function visibilityRules() external pure override returns (VisibilityConfig memory) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        EventLogConfig[]  memory eventLogConfigs = new EventLogConfig[](2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // the signature of &quot;event DataChanged(address indexed account, uint256 newValue);&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 dataChangedEventSig = hex&quot;0xec851d5c322f7f1dd5581f7432e9f6683a8709a4b1ca754ccb164742b82a7d2f&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Field[]  memory relevantTo = new Field[](2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        relevantTo[0] = Field.TOPIC1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        relevantTo[1] = Field.SENDER;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        eventLogConfigs[0] = EventLogConfig(dataChangedEventSig, relevantTo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // the signature of &quot;event MilestoneReached(uint256 noStoredValues);&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 milestoneReachedEventSig = hex&quot;0xd41033274424d56dd572e7196fb4230cf4141d546b91fc00555cab8403965924&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Field[]  memory relevantTo = new Field[](1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        relevantTo[0] = Field.EVERYONE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        eventLogConfigs[1] = EventLogConfig(milestoneReachedEventSig, relevantTo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return VisibilityConfig(ContractCfg.PRIVATE, eventLogConfigs);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-4">Explanation<a href="#explanation-4" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<p>The <a href="https://github.com/ten-protocol/go-ten/blob/main/contracts/src/system/config/IContractTransparencyConfig.sol" target="_blank" rel="noopener noreferrer"><code>ContractTransparencyConfig</code></a> interface is known by the TEN platform.
When a contract is deployed, the platform will call the <code>visibilityRules</code> function, and store the <code>VisibilityConfig</code>.</p>
<p>For each event type, you can configure which fields can access it.</p>
<p>Notice how in the <code>visibilityRules</code> above, we configure the <code>DataChanged</code> event to be visible to the first field and the sender, and the <code>MilestoneReached</code> to be visible to everyone.</p>
<p>The other configuration: <code>VisibilityConfig.contractCfg</code> applies to the entire contract:</p>
<ul>
<li><code>ContractCfg.TRANSPARENT</code>: The contracts will have public storage and events, behaving exactly like Ethereum.</li>
<li><code>ContractCfg.PRIVATE</code>: The default TEN behaviour, where the storage is not accessible and the events are individually configurable.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/ten-protocol/ten-documentation/blob/main/docs/3-smart-contract-features/1-data-access.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/smart-contract-features"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Smart Contract Features</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/smart-contract-features/native-entropy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Native secure entropy</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#data-access-control-rules" class="table-of-contents__link toc-highlight">Data Access Control Rules</a></li><li><a href="#data-access-control-example" class="table-of-contents__link toc-highlight">Data Access Control Example</a><ul><li><a href="#step-1-basic-contract-with-a-public-variable" class="table-of-contents__link toc-highlight">Step 1: Basic contract with a Public Variable</a></li><li><a href="#step-2-converting-to-a-private-variable-with-an-explicit-getter-function" class="table-of-contents__link toc-highlight">Step 2: Converting to a Private Variable with an explicit Getter Function</a></li><li><a href="#step-3-data-access-control" class="table-of-contents__link toc-highlight">Step 3: Data Access Control</a></li><li><a href="#step-4-emitting-events---default-visibility" class="table-of-contents__link toc-highlight">Step 4: Emitting Events - Default Visibility</a></li><li><a href="#step-5-customising-event-visibility" class="table-of-contents__link toc-highlight">Step 5: Customising Event Visibility</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/category/introduction">Introduction</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://t.co/UJC0FUAY2T" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/tenprotocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://medium.com/obscuro-labs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/ten-protocol/ten-documentation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Ten Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>