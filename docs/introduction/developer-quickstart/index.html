<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-introduction/developer-quickstart" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Migrate your dApp to TEN | TEN Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.ten.xyz/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.ten.xyz/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.ten.xyz/docs/introduction/developer-quickstart"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Migrate your dApp to TEN | TEN Documentation"><meta data-rh="true" name="description" content="Migrating to TEN enables your dApp to leverage &quot;Programmable Encryption&quot;. Below are steps to help you transition smoothly."><meta data-rh="true" property="og:description" content="Migrating to TEN enables your dApp to leverage &quot;Programmable Encryption&quot;. Below are steps to help you transition smoothly."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.ten.xyz/docs/introduction/developer-quickstart"><link data-rh="true" rel="alternate" href="https://docs.ten.xyz/docs/introduction/developer-quickstart" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.ten.xyz/docs/introduction/developer-quickstart" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Introduction","item":"https://docs.ten.xyz/docs/category/introduction"},{"@type":"ListItem","position":2,"name":"Migrate your dApp to TEN","item":"https://docs.ten.xyz/docs/introduction/developer-quickstart"}]}</script><link rel="stylesheet" href="/assets/css/styles.4f600b22.css">
<script src="/assets/js/runtime~main.2528fbe2.js" defer="defer"></script>
<script src="/assets/js/main.c36c519c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TEN Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="TEN Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/introduction">Documentation</a><a href="https://medium.com/obscuro-labs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="/llms.txt" class="navbar__item navbar__link" target="_blank">llms.txt</a><a href="/llms-full.txt" class="navbar__item navbar__link" target="_blank">llms-full.txt</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/introduction">Introduction</a><button aria-label="Collapse sidebar category &#x27;Introduction&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/introduction/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/introduction/features">Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/introduction/technology">Technology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/introduction/developer-quickstart">Migrate your dApp to TEN</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/getting-started">Getting started</a><button aria-label="Expand sidebar category &#x27;Getting started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/architecture">Architecture</a><button aria-label="Expand sidebar category &#x27;Architecture&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/standards--primitives">Standards &amp; Primitives</a><button aria-label="Expand sidebar category &#x27;Standards &amp; Primitives&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tools--infrastructure">Tools &amp; Infrastructure</a><button aria-label="Expand sidebar category &#x27;Tools &amp; Infrastructure&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tutorials--examples">Tutorials &amp; Examples</a><button aria-label="Expand sidebar category &#x27;Tutorials &amp; Examples&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/api-references">API References</a><button aria-label="Expand sidebar category &#x27;API References&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/troubleshooting">Troubleshooting</a><button aria-label="Expand sidebar category &#x27;Troubleshooting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/testnet">Testnet</a><button aria-label="Expand sidebar category &#x27;Testnet&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/governance">Governance</a><button aria-label="Expand sidebar category &#x27;Governance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ReleaseNotes">Release Notes</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/introduction"><span>Introduction</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Migrate your dApp to TEN</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Migrate your dApp to TEN</h1></header>
<p>Migrating to TEN enables your dApp to leverage &quot;Programmable Encryption&quot;. Below are steps to help you transition smoothly.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-migration-steps">Key Migration Steps<a href="#key-migration-steps" class="hash-link" aria-label="Direct link to Key Migration Steps" title="Direct link to Key Migration Steps">​</a></h3>
<ul>
<li>Update your Hardhat deployment to support the <code>--network ten</code> option.</li>
<li>Add data protection logic to your view functions (if applicable).</li>
<li>Configure visibility rules for event logs and internal storage.</li>
<li>Add the TEN onboarding widget to your JavaScript UI.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-configuring-hardhat">1. Configuring Hardhat<a href="#1-configuring-hardhat" class="hash-link" aria-label="Direct link to 1. Configuring Hardhat" title="Direct link to 1. Configuring Hardhat">​</a></h2>
<p>First, set up a Hardhat project if you haven&#x27;t already.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-installing-the-ten-hardhat-plugin">1.1 Installing the TEN Hardhat Plugin<a href="#11-installing-the-ten-hardhat-plugin" class="hash-link" aria-label="Direct link to 1.1 Installing the TEN Hardhat Plugin" title="Direct link to 1.1 Installing the TEN Hardhat Plugin">​</a></h3>
<p>To add TEN Network compatibility, install the <code>ten-hardhat-plugin</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm install ten-hardhat-plugin</span><br></span></code></pre></div></div>
<p><em>You can use <code>npm</code> or <code>yarn</code> to install plugins.</em></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-configuring-hardhatconfigjs">1.2 Configuring <code>hardhat.config.js</code><a href="#12-configuring-hardhatconfigjs" class="hash-link" aria-label="Direct link to 12-configuring-hardhatconfigjs" title="Direct link to 12-configuring-hardhatconfigjs">​</a></h3>
<p>Modify <code>hardhat.config.js</code> in your project’s root directory as follows:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">HardhatUserConfig</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hardhat/config&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@nomiclabs/hardhat-waffle&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ten-hardhat-plugin&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">solidity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.8.10&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">networks</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">hardhat</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Configuration for the Hardhat Network</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">ten</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://testnet.ten.xyz/v1/&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">chainId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">443</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">accounts</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;your-private-key&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>Once configured, you can start writing or migrating your smart contracts.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-writing-smart-contracts-for-ten">2. Writing Smart Contracts for TEN<a href="#2-writing-smart-contracts-for-ten" class="hash-link" aria-label="Direct link to 2. Writing Smart Contracts for TEN" title="Direct link to 2. Writing Smart Contracts for TEN">​</a></h2>
<p>TEN executes smart contracts within the EVM similarly to Ethereum, so you can reuse your existing code.
However, the execution and the internal state are hidden from everyone, including node operators and the sequencer.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>TEN encrypts both the execution and its internal database using Trusted Execution Environments (TEEs).</p></div></div>
<p>The <a href="https://docs.alchemy.com/reference/eth-getstorageat" target="_blank" rel="noopener noreferrer">getStorageAt</a> method is disabled by default on TEN, so data access relies on view functions that you define.
Public variables remain accessible as Solidity automatically creates getters for them.</p>
<p>Let&#x27;s illustrate with a basic storage dApp example where users can store and retrieve a number.</p>
<p>At every step, we&#x27;ll add a new feature and explain the difference between <code>TEN</code> and <code>Ethereum</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-basic-contract-with-a-public-variable">Step 1: Basic contract with a Public Variable<a href="#step-1-basic-contract-with-a-public-variable" class="hash-link" aria-label="Direct link to Step 1: Basic contract with a Public Variable" title="Direct link to Step 1: Basic contract with a Public Variable">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code">Code<a href="#code" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h4>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: MIT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract StorageExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) public storedValues;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function storeValue(uint256 value) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        storedValues[tx.origin] = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation">Explanation<a href="#explanation" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<p>In this step, we created a public variable <code>storedValues</code> that maps the provided value to the address of the user who called the <code>storeValue</code> function.</p>
<p>Because the variable is public, Solidity will provide a default public getter for it.</p>
<p>Since there are no data access restrictions, on both Ethereum and TEN, everyone will be able to read the values of all users.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-converting-to-a-private-variable-with-an-explicit-getter-function">Step 2: Converting to a Private Variable with an explicit Getter Function<a href="#step-2-converting-to-a-private-variable-with-an-explicit-getter-function" class="hash-link" aria-label="Direct link to Step 2: Converting to a Private Variable with an explicit Getter Function" title="Direct link to Step 2: Converting to a Private Variable with an explicit Getter Function">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-1">Code<a href="#code-1" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h4>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract StorageExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) private _storedValues;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function storeValue(uint256 value) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _storedValues[tx.origin] = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getValue(address account) public view returns (uint256) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _storedValues[account];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-1">Explanation<a href="#explanation-1" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<p>The <code>storedValues</code> variable is now private, and we added a basic <code>getValue</code> function for users to retrieve their value.</p>
<p>On both Ethereum and TEN, anyone can call <code>getValue</code> to retrieve any value.<br>
<!-- -->On Ethereum, <code>_storedValues</code> can also be accessed directly with <code>getStorageAt</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3--data-access-control">Step 3:  Data Access Control<a href="#step-3--data-access-control" class="hash-link" aria-label="Direct link to Step 3:  Data Access Control" title="Direct link to Step 3:  Data Access Control">​</a></h3>
<p>In this step, we&#x27;ll add restrictions so users can only access their own data.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-2">Code<a href="#code-2" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h4>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract StorageExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) private _storedValues;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function storeValue(uint256 value) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _storedValues[tx.origin] = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getValue(address account) public view returns (uint256) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(tx.origin == account, &quot;Not authorized!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _storedValues[account];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-2">Explanation<a href="#explanation-2" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<p>The key line is: <code>require(tx.origin == account, &quot;Not authorized!&quot;);</code>, which ensures that the caller of the view function is the owner of the data.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>TEN uses  &quot;Viewing Keys&quot; to authenticate view function calls.</p></div></div>
<p><strong>When deployed on TEN, this code guarantees that all users can only access their own values, and nobody can read the <code>_storedValues</code>.</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-emitting-events---default-visibility">Step 4: Emitting Events - Default Visibility<a href="#step-4-emitting-events---default-visibility" class="hash-link" aria-label="Direct link to Step 4: Emitting Events - Default Visibility" title="Direct link to Step 4: Emitting Events - Default Visibility">​</a></h3>
<p>Event logs notify UIs about state changes in smart contracts.</p>
<p>To improve our smart contract, we’ll emit an event when a user stores a value and milestone events when a specific size threshold is met.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-3">Code<a href="#code-3" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h4>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract StorageExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) private _storedValues;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 private totalCalls = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event DataChanged(address indexed account, uint256 newValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event MilestoneReached(uint256 noStoredValues);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function storeValue(uint256 value) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _storedValues[tx.origin] = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit DataChanged(tx.origin, value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        totalCalls++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (totalCalls % 1000 == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            emit MilestoneReached(totalCalls);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getValue(address account) public view returns (uint256) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(tx.origin == account, &quot;Not authorized!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _storedValues[account];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-3">Explanation<a href="#explanation-3" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<p>Notice how we defined the two events: <code>DataChanged</code> and <code>MilestoneReached</code>, and are emitting them in the <code>storeValue</code> function.</p>
<p>In Ethereum, everyone can query and subscribe to these events. This obviously can&#x27;t be the case for TEN because it would completely break the functionality.</p>
<p>Notice how in this version, we have no configuration for event log visibility, so we are relying on the default rules.</p>
<p>Rule 1: Event logs that contain EOAs as indexed fields (topics) are only visible to those EOAs.
Rule 2: Event logs that don&#x27;t contain any EOA are visible to everyone.</p>
<p>In our case, the default rules ensure that:</p>
<ul>
<li><code>DataChanged</code> is visible only to the address that is storing the value.</li>
<li><code>MilestoneReached</code> is publicly visible.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-customizing-event-visibility">Step 5: Customizing Event Visibility<a href="#step-5-customizing-event-visibility" class="hash-link" aria-label="Direct link to Step 5: Customizing Event Visibility" title="Direct link to Step 5: Customizing Event Visibility">​</a></h3>
<p>The default visibility rules are a good starting point, but complex dApps require greater flexibility.</p>
<p>TEN give you explicit control over event visibility.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-4">Code<a href="#code-4" class="hash-link" aria-label="Direct link to Code" title="Direct link to Code">​</a></h4>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">interface ContractTransparencyConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enum Field { TOPIC1, TOPIC2, TOPIC3, SENDER, EVERYONE }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enum ContractCfg { TRANSPARENT, PRIVATE }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    struct EventLogConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 eventSignature;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Field[] visibleTo;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    struct VisibilityConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ContractCfg contractCfg;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        EventLogConfig[] eventLogConfigs;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function visibilityRules() external pure returns (VisibilityConfig memory);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract StorageExample is ContractTransparencyConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address =&gt; uint256) private _storedValues;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    uint256 private totalCalls = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event DataChanged(address indexed account, uint256 newValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event MilestoneReached(uint256 noStoredValues);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function storeValue(uint256 value) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _storedValues[tx.origin] = value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit DataChanged(tx.origin, value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        totalCalls++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (totalCalls % 1000 == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            emit MilestoneReached(totalCalls);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getValue(address account) public view returns (uint256) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(tx.origin == account, &quot;Not authorized!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _storedValues[account];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function visibilityRules() external pure override returns (VisibilityConfig memory) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        EventLogConfig[]  memory eventLogConfigs = new EventLogConfig[](2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // the signature of &quot;event DataChanged(address indexed account, uint256 newValue);&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 dataChangedEventSig = hex&quot;0xec851d5c322f7f1dd5581f7432e9f6683a8709a4b1ca754ccb164742b82a7d2f&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Field[]  memory relevantTo = new Field[](2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        relevantTo[0] = Field.TOPIC1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        relevantTo[1] = Field.SENDER;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        eventLogConfigs[0] = EventLogConfig(dataChangedEventSig, relevantTo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // the signature of &quot;event MilestoneReached(uint256 noStoredValues);&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes32 milestoneReachedEventSig = hex&quot;0xd41033274424d56dd572e7196fb4230cf4141d546b91fc00555cab8403965924&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Field[]  memory relevantTo = new Field[](1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        relevantTo[0] = Field.EVERYONE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        eventLogConfigs[1] = EventLogConfig(milestoneReachedEventSig, relevantTo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return VisibilityConfig(ContractCfg.PRIVATE, eventLogConfigs);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-4">Explanation<a href="#explanation-4" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<p>The <code>ContractTransparencyConfig</code> interface is known by the TEN platform.
When a contract is deployed, the platform will call the <code>visibilityRules</code> function, and store the <code>VisibilityConfig</code>.</p>
<p>For each event type, you can configure which fields can access it.
This allows the developer to configure an event to be public even if it has EOAs or to allow the sender of the transaction to access events emitted even if the address is not in the event.</p>
<p>Notice how in the <code>visibilityRules</code> above, we configure the <code>DataChanged</code> event to be visible to the first field and the sender, and the <code>MilestoneReached</code> to be visible to everyone.</p>
<p>The other configuration: <code>VisibilityConfig.contractCfg</code> applies to the entire contract:</p>
<ul>
<li><code>ContractCfg.TRANSPARENT</code>: The contracts will have public storage and events, behaving exactly like Ethereum.</li>
<li><code>ContractCfg.PRIVATE</code>: The default TEN behaviour, where the storage is not accessible and the events are individually configurable.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="account-abstraction---native-session-keys">Account Abstraction - Native Session Keys<a href="#account-abstraction---native-session-keys" class="hash-link" aria-label="Direct link to Account Abstraction - Native Session Keys" title="Direct link to Account Abstraction - Native Session Keys">​</a></h2>
<p>The key feature of <a href="https://medium.com/p/2e85bde4c54d" target="_blank" rel="noopener noreferrer">&quot;Account Abstraction&quot;</a> (EIP-4337) is &quot;Session keys&quot;(SK) through a proxy smart contract.
SKs allow users to interact with the blockchain without having to sign every transaction, which is a major UX improvement.</p>
<p>TEN supports &quot;native&quot; SKs - these are managed by the platform and do not require a proxy contract.</p>
<p>In TEN, SKs are managed by dApp developers through dedicated RPC endpoints.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-overview">Solution overview<a href="#solution-overview" class="hash-link" aria-label="Direct link to Solution overview" title="Direct link to Solution overview">​</a></h3>
<p>Imagine you&#x27;re developing an on-chain game, and you want a smooth UX without the distraction of signing every move.</p>
<p>Conceptually, the game will create a session key (SK) for the user, then ask the user to move some funds to that address, and then create &quot;move&quot; transactions signed with the SK.</p>
<p>If the game were to create the SK in the browser, there would be a risk of the user losing the SK, and the funds associated with it, in case of an accidental exit.
With TEN, the dApp developer doesn&#x27;t have to worry about this, because the SKs are managed by TEEs.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<p>The below describe the implementation steps for the game developer - which is the main usecase for SKs.
Note that it can be used for any dApp that requires a no-click UX.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="when-the-game-starts">When the game starts<a href="#when-the-game-starts" class="hash-link" aria-label="Direct link to When the game starts" title="Direct link to When the game starts">​</a></h4>
<p>Before the user can start playing, the game must create the SK and ask the user to move some funds to that address.
The funds will be used to pay for moves.</p>
<ul>
<li>Call the RPC <code>sessionkeys_Create</code> - without any parameters. This will return a hex-encoded address of the SK.</li>
<li>Create a normal transaction that transfers some ETH to the SK. The amount depends on how many &quot;moves&quot; the user is prepared to prepay for.</li>
<li>Ask the user to sign this transaction with their normal wallet, and submit it to the network using the library of your choice.</li>
<li>Once the receipt is received, call <code>sessionkeys_Activate</code>.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-game">The game<a href="#the-game" class="hash-link" aria-label="Direct link to The game" title="Direct link to The game">​</a></h4>
<p>After activation of the SK, create a transaction for each move, but don&#x27;t ask the user to sign them.
Instead, submit them to the network unsigned using the RPCs: <code>eth_sendRawTransaction</code> or <code>eth_sendTransaction</code>.</p>
<p>Because the SK is active, the platform will sign the transactions on behalf of the user.</p>
<p>As a game developer, you are responsible to keep track of the balance of the SK. You can also query the network for the balance of the address.
If the SK runs out of balance, you have to ask the user to move more funds to the SK.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="managing-session-keys">Managing Session Keys<a href="#managing-session-keys" class="hash-link" aria-label="Direct link to Managing Session Keys" title="Direct link to Managing Session Keys">​</a></h4>
<p>TEN provides additional RPC endpoints for managing session keys:</p>
<ul>
<li>
<p><code>sessionkeys_Delete</code> - Permanently removes the session key. This can only be called after deactivating the key. This is useful when you want to clean up unused session keys or when a user wants to completely remove their session key.</p>
</li>
<li>
<p><code>sessionkeys_List</code> - Returns the address of the current session key, or an empty response if no session key exists. This is useful for checking if a user has an active session key and getting its address.</p>
</li>
</ul>
<p>The session key management endpoints can be called through both HTTP API and RPC methods. For RPC, you can use <code>eth_getStorageAt</code> with specific addresses:</p>
<ul>
<li>Create: <code>0x0000000000000000000000000000000000000003</code></li>
<li>Activate: <code>0x0000000000000000000000000000000000000004</code></li>
<li>Deactivate: <code>0x0000000000000000000000000000000000000005</code></li>
<li>Delete: <code>0x0000000000000000000000000000000000000006</code></li>
<li>List: <code>0x0000000000000000000000000000000000000007</code></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="finishing-the-game">Finishing the game<a href="#finishing-the-game" class="hash-link" aria-label="Direct link to Finishing the game" title="Direct link to Finishing the game">​</a></h4>
<p>When a game ends, you have to move the remaining funds back to the main address and deactivate the key.</p>
<ul>
<li>create a Tx that moves the funds back from the SK to the main address. Submit it unsigned, because the funds are controlled by the SK.</li>
<li>call the RPC: <code>sessionkeys_Deactivate</code>- from now on, unsigned transactions will no longer be signed by the SK.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="game-security">Game Security<a href="#game-security" class="hash-link" aria-label="Direct link to Game Security" title="Direct link to Game Security">​</a></h2>
<p>Every on-chain game developer knows that every move that relies on entropy must be executed in two steps.</p>
<p>Imagine you implement an on-chain coin flip game. The player pays 0.1ETH to choose <code>Heads</code> or <code>Tails</code>.
If they win, they receive 0.2ETH, otherwise they lose the 0.1ETH.
Even if randomness is unpredictable, this simple game can be exploited in several ways:</p>
<ul>
<li>The attacker can create a “proxy” smart contract to play on their behalf. Using a similar mechanism to flash loans in DeFi: the proxy is programmed to make multiple actions, and only “commit” if it can obtain a profit. In our case, if the coin flip is losing, the proxy can just revert. The only cost will be the gas burned.</li>
<li>Transactions consume gas, and the gas cost can inadvertently reveal information. For instance, if a winning move is more computationally intensive than a losing one, players could deduce optimal moves by estimating gas costs for various actions.</li>
</ul>
<p>The typical solution is to use a commit-reveal scheme. The player commits to a move, and then reveals it. This way, the player can&#x27;t change their mind after seeing the result.
This solution has the major drawback that it introduces extra complexity, latency and cost.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-on-block-end-callback">The on-block-end callback<a href="#the-on-block-end-callback" class="hash-link" aria-label="Direct link to The on-block-end callback" title="Direct link to The on-block-end callback">​</a></h3>
<p>The best solution is to decouple the move from the execution without increasing the latency or the cost.
This way, the side-channel attacks are no longer possible because the move is not executed immediately.
To avoid increasing the latency, the move must be executed at the end of the block.
Note that contracts can define the handleRefund function, which will be called with value equal to what is left from the gas processing paid for.
This is called with enough gas to save locally how much should be refunded to whoever paid for the callback.</p>
<p>See below a simple implementation of the coin flip game using the TEN platform:</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: MIT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// this interface is known by the TEN system contract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface TenCallbacks {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function register(bytes calldata) external payable returns (uint256);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface Refunds {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function handleRefund(uint256 callbackId) external payable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract CoinFlip {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Event to emit the result of the coin flip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event CoinFlipResult(address indexed player, bool didWin, uint256 randomNumber);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private TenCallbacks tenCallbacks;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(uint256 callbackId =&gt; address player) public callbackToPlayer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping(address player =&gt; uint256 refundAmount) public playerToRefundAmount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifier onlyTenSystemCall() { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(msg.sender == address(tenCallbacks));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // you have to pass in the address of the callbacks contract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(address _tenCallbacksAddress) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tenCallbacks = TenCallbacks(_tenCallbacksAddress);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Function to initiate a coin flip. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Notice how it doesn&#x27;t execute the coin flip directly, but instead registers a callback.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function flipCoin(bool isHeads) external payable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Assume doFlipCoin costs 50_000 gas;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // We deduct a predetermined amount from the bet to pay for delayed execution.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 etherGasForCoinFlip = 50_000*block.basefee;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(msg.value &gt; etherGasForCoinFlip, &quot;Insufficent gas&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Encode the function we want to be called by the TEN system contract.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bytes memory callbackTargetInfo = abi.encodeWithSelector(this.doFlipCoin.selector, msg.sender, msg.value - etherGasForCoinFlip, isHeads);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tenCallbacks.register{value: etherGasForCoinFlip}(callbackTargetInfo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Function to simulate a coin flip - notice that this must only be callable by the ten system contract.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // This function is called by the TEN platform as a synthetic transaction in the same block as the user transaction.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function doFlipCoin(address bettor, uint256 stake, bool wantsHeads) external onlyTenSystemCall {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Assume getRandomNumber() is a function that returns a random number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 randomNumber = getRandomNumber();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Simulate a coin flip: 0 for tails, 1 for heads</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bool isHeads = (randomNumber % 2) == 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (wantsHeads == isHeads) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //pay out to winner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            (bool success, ) = payable(bettor).call{value: stake*2}(&quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            require(success, &quot;Payment failed.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Emit the result of the coin flip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emit CoinFlipResult(msg.sender, isHeads, randomNumber);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function getRandomNumber() internal view returns (uint256) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return block.prevrandao;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function handleRefund(uint256 callbackId) external payable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        address player = callbackToPlayer[callbackId];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        playerToRefundAmount[player] += msg.value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function claimRefund() external {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uint256 refundAmount = playerToRefundAmount[msg.sender];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(refundAmount &gt; 0, &quot;No refunds to claim&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        playerToRefundAmount[msg.sender] = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (bool success, ) = payable(msg.sender).call{value: refundAmount}(&quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        require(success, &quot;Transfer failed&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/ten-protocol/ten-documentation/blob/main/docs/introduction/developer-quickstart.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/introduction/technology"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Technology</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/getting-started"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Getting started</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#key-migration-steps" class="table-of-contents__link toc-highlight">Key Migration Steps</a></li><li><a href="#1-configuring-hardhat" class="table-of-contents__link toc-highlight">1. Configuring Hardhat</a><ul><li><a href="#11-installing-the-ten-hardhat-plugin" class="table-of-contents__link toc-highlight">1.1 Installing the TEN Hardhat Plugin</a></li><li><a href="#12-configuring-hardhatconfigjs" class="table-of-contents__link toc-highlight">1.2 Configuring <code>hardhat.config.js</code></a></li></ul></li><li><a href="#2-writing-smart-contracts-for-ten" class="table-of-contents__link toc-highlight">2. Writing Smart Contracts for TEN</a><ul><li><a href="#step-1-basic-contract-with-a-public-variable" class="table-of-contents__link toc-highlight">Step 1: Basic contract with a Public Variable</a></li><li><a href="#step-2-converting-to-a-private-variable-with-an-explicit-getter-function" class="table-of-contents__link toc-highlight">Step 2: Converting to a Private Variable with an explicit Getter Function</a></li><li><a href="#step-3--data-access-control" class="table-of-contents__link toc-highlight">Step 3:  Data Access Control</a></li><li><a href="#step-4-emitting-events---default-visibility" class="table-of-contents__link toc-highlight">Step 4: Emitting Events - Default Visibility</a></li><li><a href="#step-5-customizing-event-visibility" class="table-of-contents__link toc-highlight">Step 5: Customizing Event Visibility</a></li></ul></li><li><a href="#account-abstraction---native-session-keys" class="table-of-contents__link toc-highlight">Account Abstraction - Native Session Keys</a><ul><li><a href="#solution-overview" class="table-of-contents__link toc-highlight">Solution overview</a></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a></li></ul></li><li><a href="#game-security" class="table-of-contents__link toc-highlight">Game Security</a><ul><li><a href="#the-on-block-end-callback" class="table-of-contents__link toc-highlight">The on-block-end callback</a></li></ul></li></ul></div></div></div></div></main></div></div></div><div id="ms-floating-button" class="ms-fixed ms-bottom-4 ms-right-8 ms-z-[100] ms-flex ms-flex-col ms-items-end hover:ms-cursor-pointer"><div class="ms-relative ms-mb-4"><div style="background-color:#000" class="ms-absolute -ms-bottom-1 ms-right-6 -ms-z-10 ms-h-4 ms-w-4 ms-rotate-45"></div><div style="background-color:#000" class="ms-z-10 ms-flex ms-items-center ms-justify-center ms-rounded-lg ms-px-3 ms-py-2"><p style="color:#fff;margin:0" class="ms-text-sm">Hi, how can I help you?</p></div></div><div style="background-color:#000" class="ms-flex ms-h-16 ms-w-16 ms-flex-col ms-items-center ms-justify-center ms-self-end ms-rounded-full ms-p-2 ms-transition"><div class="ms-rotate-0 ms-flex ms-h-full ms-w-full ms-transform ms-cursor-pointer ms-items-center ms-justify-center ms-rounded-full ms-transition-all ms-delay-75 ms-duration-100 ms-ease-in-out"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg></div></div><div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/category/introduction">Introduction</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://t.co/UJC0FUAY2T" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/tenprotocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://medium.com/obscuro-labs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/ten-protocol/ten-documentation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Ten Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>